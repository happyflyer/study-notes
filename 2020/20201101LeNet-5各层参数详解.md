# LeNet-5 各层参数详解

- [LeNet-5, convolutional neural networks](http://yann.lecun.com/exdb/lenet/index.html)

![LeNet-5各层参数详解图](https://cdn.jsdelivr.net/gh/happyflyer/picture-bed@main/2021/LeNet-5各层参数详解图.2srj0pig7zo0.jpeg)

## 1. C1 卷积层

- 输入图片尺寸：$32*32$
- 卷积核大小：$5*5$
- 卷积核数量：$6$
- 输出 feature map 尺寸：$28*28*6$
- 可训练参数：$(5*5+1)*6 = 156$
- 连接数：$(5*5+1)*6*28*28 = 122304$

## 2. S2 下采样层

- 输入 feature map 尺寸：$28*28*6$
- 采样区域：$2*2$
- 采样方式：$4$ 个输入相加，乘以一个可训练参数，再加上一个可训练偏置。结果通过 $sigmoid$
- 输出 feature map 尺寸：$14*14*6$
- 可训练参数：$(1+1)*6 = 12$
- 连接数：$(2*2+1)*6*14*14 = 5880$

## 3. C3 卷积层

- 输入 feature map 尺寸：$14*14*6$
- 卷积核大小：$5*5$
- 卷积核数量：$16$
- 卷积方式：$C3$ 中的每个特征 map 是连接到 $S2$ 中的所有 $6$ 个或者几个特征 map 的，表示本层的特征 map 是上一层提取到的特征 map 的不同组合（这个做法也并不是唯一的）。存在的一个方式是：$C3$ 的前 $6$ 个特征图以 $S2$ 中 $3$ 个相邻的特征图子集为输入。接下来 $6$ 个特征图以 $S2$ 中 $4$ 个相邻特征图子集为输入。然后的 $3$ 个以不相邻的 $4$ 个特征图子集为输入。最后一个将 $S2$ 中所有特征图为输入。
- 输出 feature map 尺寸：$10*10*16$
- 可训练参数：$(5*5*3+1)*6+(5*5*4+1)*6+(5*5*4+1)*3+(5*5*6+1) = 1516$
- 连接数：$1516*10*10 = 151600$

## 4. S4 下采样层

- 输入 feature map 尺寸：$10*10*16$
- 采样区域：$2*2$
- 采样方式：$4$ 个输入相加，乘以一个可训练参数，再加上一个可训练偏置。结果通过 $sigmoid$
- 输出 feature map 尺寸：$5*5*16 = 400$
- 可训练参数：$(1+1)*16 = 32$
- 连接数：$(2*2+1)*16*5*5 = 2000$

## 5. C5 卷积层

- 输入 feature map 尺寸：$5*5*16$
- 卷积核大小：$5*5$
- 卷积核数量：$120$
- 输出 feature map 尺寸：$1*1*120$
- 可训练参数：$(5*5*16+1)*120 = 48120$
- 连接数：$48120*1*1 = 48120$

## 6. F6 全连接层

- 输入 feature map 尺寸：$120$
- 输出 feature map 尺寸/神经元数量：$84$
- 可训练参数：$(120+1)*84 = 10164$
- 连接数：$10164$

## 7. F7 全连接层

- 输入 feature map 尺寸：$84$
- 输出 feature map 尺寸/神经元数量：$10$
- 可训练参数：$(84+1)*10 = 850$
- 连接数：$850$
